---
title: Atividade Computacional 1
author: Daniel de Amaral da Silva
date: March 20, 2019
output:
  prettydoc::html_pretty:
    theme: architect
    highlight: github
---
<center>**Setando a semente**</center>
```{r}
set.seed(22022019)
```

<center>**Pacotes necessários**</center>
```{r loadlib, echo=T, results='hide', message=F, warning=F}
library(kableExtra)
library(dplyr)
library(TeachingSampling)
library(ggplot2)
```

<center>**Dataset Lucy**</center>
```{r warning=FALSE}
data(Lucy)
attach(Lucy)

head(Lucy) %>% 
  kable('html') %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```
<style>
body {text-align: justify}
</style>

<center>**Atividades**</center>
**1.** Fazer uma análise descritiva da variável Income (Renda). Sugestão: é muito importante pesquisar (estudar) a base de dados Lucy antes de fazer a análise descritiva.  
```{r fig.align='center'}
Lucy %>% ggplot(aes(Lucy$Income)) + 
  geom_histogram(binwidth = 140,
                  col="red", 
                  fill='#2879d0', 
                  alpha = .5) +
  scale_x_continuous(breaks = seq(0, 2550, by = 200))+
  labs(title="Histograma para Lucro") +
  ylab('Frequência') +
  xlab('Lucro')
```

> Observa-se pela análise visual do Histograma que a variável Income (lucro), possui uma distribuição assimétrica à esquerda, e que possui alguns valores atípicos em comparação com o comportamento da maioria.

```{r}
s = summary(Lucy$Income)
estatisticas = as.vector(s)
as.data.frame(estatisticas, names(s)) %>% 
  kable('html') %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

> Nota-se a presença de valores atípicos ao analisar o intervalo entre o 3º Quartil e o valor Máximo

```{r fig.align='center'}
Lucy %>% ggplot(aes(y = Lucy$Income, x = 'Income')) + 
  geom_boxplot(outlier.size = 3, fill='#2879d0', alpha = .6) +
  theme(axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank()) + 
  scale_y_continuous(breaks = seq(0, 2550, by = 200))+
  labs(title = 'Boxplot para Lucro') +
  ylab('Lucro')+
  coord_flip()
```

> Fica evidente com a visualização do histograma que 50% das empresas tiveram lucros entre 230 e 576 e de que menos de 25% das empresas possuiram um padrão de lucro acima de 1000. Apesar de termos constatados valores atípicos, tal fato só reforça a idéia de que há empresas que cresceram bastante em comparação ao ano em questão, em contraste com isto menos de 25% das empresas estudadas tiveram lucro de menos que 230. Contudo, nenhuma teve lucro negativo (prejuizo).

**2.** Obter uma amostra mediante uma amostragem de Bernoulli usando $\pi = 0,2$. Calcular o $\pi$-estimador de total e sua respectiva variância estimada para a variável Income. (Analisar os resultados)  
```{r}
# Amostragem Bernoulli(2396, 0.2)
pi = 0.2
N = dim(Lucy)[1]
am_ber_ik = S.BE(N, pi)
am_ber = Lucy[am_ber_ik, ]
dim(am_ber)

# Pi-estimador
pi_est = E.BE(am_ber['Income'], pi)
pi_est %>% 
  kable('html') %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```
> Ao a analisar os resultados notamos que as Estimações do tamanho amostral e do Total da variável Income se aproximam do valor real, isto é evidenciado pelo Erro padrão e pelo Coeficiente de Variação estimado, que nos mostra um erro de tolerância de 4.75% e nos indica um sinal de homogeneidade da população.
  
**3.** O tamanho amostral obtido no item anterior é semelhante ou muito diferente do esperado? Justificar sua resposta  

> É semelhante sim, o tamanho esperado numa amostragem de Bernoulli tem distribuição Binomial e sua esperança é dada por:

$$ \mathbb{E}[n_s] = N\pi, \text{ dado } N = 2396 \text{ e } \pi = 0.2 $$
$$\mathbb{E}[n_s] = 479.2$$

> No experimento do item anterior obtivemos o tamanho amostral de:

```{r echo=FALSE}
dim(am_ber)[1]
```


> Podemos então notar a proximidade do tamanho esperado 479.2 e o observado 480.

**4.** Obter uma amostra de tamanho $480$ mediante uma amostragem simples sem reposição. Calcular o $\pi$-estimador de total e sua respectiva variância estimada para a variável Income. (Analisar os resultados)  

```{r}
# Amostragem Aleatória Simples
n = 480
am_si_ik = S.SI(N, n)
am_si = Lucy[am_si_ik, ]
dim(am_si)

# Pi-estimador
pi_est2 = E.SI(N, n, am_si['Income'])
pi_est2 %>%
  kable('html') %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```


**5.** Comprar os resultados obtidos nas questões 2 e 4.  
**6.** A variável Level tem três categorias (Big, Medium e Small). Suponha que cada categoria é uma população diferente. Obtenha uma amostra aleatória simples sem reposição para cada categoria do 20% do tamanho de cada população. Calcular o $\pi$-estimador e sua respectiva variância para cada categoria. Com estes resultados é possível obter uma estimativa para o total de população em geral e sua variância estimada? Caso que a resposta for afirmativa, quais são os valores correspondentes? Precisa fazer algumas suposições? (Justificar sua resposta).


